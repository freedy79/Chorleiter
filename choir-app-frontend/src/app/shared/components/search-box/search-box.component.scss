@use "@angular/material" as mat;
@use "../../../../themes/_nak-theme" as nak;
@use "../../../../themes/dark-mode-variables" as *;
@use "../../../../themes/breakpoints" as *;

.search-box {
  width: 100%;
  margin: 0 !important;
  padding: 0 !important;
  border: 0 !important;
  flex: 0 0 50%;
  height: 58px !important;
  justify-self: flex-start;
  padding-bottom: 10px;
}

:host {
  flex: 1;
}

.search-autocomplete-panel {
  .mat-mdc-option {
    align-items: center;
  }
}

.type-icon {
  margin-right: 0.5rem;
  font-size: 1.125rem;
  width: 1.125rem;
  height: 1.125rem;
}

.suggestion-text mark {
  @include suggestion-highlight;
}

.suggestion-subtitle {
  @include secondary-text;
}

.suggestion-meta {
  @include subtle-text;
  margin-left: 4px;
}

.loading-option {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.show-all-option {
  font-weight: 600;
}

.history-option {
  position: relative;
}

.history-delete-btn {
  position: absolute;
  right: 0;
  opacity: 0;
  @include smooth-transition(opacity, $animation-normal);
}

.history-option:hover .history-delete-btn {
  opacity: 1;
}

.clear-history-option {
  font-weight: 600;
  @include secondary-text;
}

@media (max-width: 480px) {
  .search-box {
    margin: 0;
  }
}

:root {
  @include mat.form-field-overrides((
    disabled-input-text-placeholder-color: orange,
    disabled-leading-icon-color: red,
    filled-input-text-placeholder-color: mat.m2-get-color-from-palette(nak.$choir-app-primary, 500),
  ));
}

// Light theme styles
:host-context(.light-theme) .search-box {
  color: rgba(0, 0, 0, 0.87);

  // Icon styling
  ::ng-deep .mat-mdc-form-field-icon-prefix {
    color: rgba(0, 0, 0, 0.6);
    align-items: center;
    display: flex;

    mat-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }

  // Border styling - nicht fokussiert
  ::ng-deep .mdc-notched-outline__leading,
  ::ng-deep .mdc-notched-outline__notch,
  ::ng-deep .mdc-notched-outline__trailing {
    border-color: rgba(0, 0, 0, 0.2) !important;
    @include smooth-transition(border-color, $animation-slow);
  }

  // Hover
  &:hover:not(.mat-focused):not(.mat-form-field-disabled) {
    ::ng-deep .mdc-notched-outline__leading,
    ::ng-deep .mdc-notched-outline__notch,
    ::ng-deep .mdc-notched-outline__trailing {
      border-color: rgba(0, 0, 0, 0.4) !important;
    }
  }

  // Focus
  &.mat-focused,
  &.mat-form-field-focused {
    ::ng-deep .mdc-notched-outline__leading,
    ::ng-deep .mdc-notched-outline__notch,
    ::ng-deep .mdc-notched-outline__trailing {
      border-color: rgba(0, 0, 0, 0.87) !important;
    }
  }
}

:host-context(.light-theme) input {
  color: rgba(0, 0, 0, 0.87);
  caret-color: rgba(0, 0, 0, 0.87);

  &::placeholder {
    color: rgba(0, 0, 0, 0.4);
  }
}

// Dark theme styles - EXPLIZIT WEISS
:host-context(.dark-theme) .search-box {
  color: #ffffff;

  // Icon styling - WEISS
  ::ng-deep .mat-mdc-form-field-icon-prefix {
    color: #ffffff;
    align-items: center;
    display: flex;

    mat-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }

  // Border styling - WEISS - nicht fokussiert
  ::ng-deep .mdc-notched-outline__leading,
  ::ng-deep .mdc-notched-outline__notch,
  ::ng-deep .mdc-notched-outline__trailing {
    border-color: rgba(255, 255, 255, 0.3) !important;
    @include smooth-transition(border-color, $animation-slow);
  }

  // Hover - WEISS
  &:hover:not(.mat-focused):not(.mat-form-field-disabled) {
    ::ng-deep .mdc-notched-outline__leading,
    ::ng-deep .mdc-notched-outline__notch,
    ::ng-deep .mdc-notched-outline__trailing {
      border-color: rgba(255, 255, 255, 0.7) !important;
    }
  }

  // Focus - WEISS
  &.mat-focused,
  &.mat-form-field-focused {
    ::ng-deep .mdc-notched-outline__leading,
    ::ng-deep .mdc-notched-outline__notch,
    ::ng-deep .mdc-notched-outline__trailing {
      border-color: #ffffff !important;
      border-width: 2px !important;
    }
  }
}

:host-context(.dark-theme) input {
  color: #ffffff;
  caret-color: #ffffff;

  &::placeholder {
    color: rgba(255, 255, 255, 0.7);
  }
}

:host-context(.dark-theme) .suggestion-subtitle,
:host-context(.dark-theme) .suggestion-meta {
  color: rgba(255, 255, 255, 0.7);
}

:host-context(.dark-theme) .clear-history-option {
  color: rgba(255, 255, 255, 0.7);
}
