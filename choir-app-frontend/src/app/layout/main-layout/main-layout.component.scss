:host {
  --header-height: 64px;
  --footer-height: 64px;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: calc(100vh - 64px);
}

.site-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.main-toolbar {
  position: sticky; // Die Leiste "klebt" beim Scrollen.
  top: 0; // Sie klebt am oberen Rand.
  z-index: 100; // Sie bleibt über allen anderen Inhalten.
  height: var(--header-height); // Wir verwenden unsere definierte Höhe.
  flex-wrap: wrap;
  gap: 0.5rem;
}

@media (max-width: 768px) {
  .main-toolbar {
    gap: 0.25rem;
  }
}

@media (max-width: 480px) {
  .main-toolbar {
    gap: 0;
  }
}

.logo-badge {
  font-weight: 600;
  padding: 0 0.75rem;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.15);
  margin-right: 1rem;
}

.choir-badge {
  margin: 0 1rem;
  text-transform: none;
  max-width: 140px;
  overflow: visible;
  white-space: normal;
  word-break: break-word;
  line-height: 1.2;
  height: auto;
}

.choir-badge-mobile {
  margin: 0 0.25rem;
}

@media (max-width: 768px) {
  .choir-badge {
    max-width: 100px;
    margin: 0 0.5rem;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .choir-badge {
    max-width: 80px;
    margin: 0 0.25rem;
    padding: 0 8px !important;
  }
}

app-search-box {
  flex: 1;
}

.avatar {
  background: #fff;
  color: var(--primary-color, #1976d2);
  width: 2rem;
  height: 2rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
}

.avatar-btn {
  padding: 0;
}

.search {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 12px;
  margin-top: auto;
  max-height: 40px;
}

.search-expanded {
  position: absolute;
  left: 56px;
  right: 48px;
  z-index: 10;
  background: inherit;
  animation: expandSearch 200ms cubic-bezier(0.4, 0, 0.2, 1);
  /* Phase 10: GPU acceleration for search expansion */
  will-change: transform, opacity;
  transform: translate3d(0, 0, 0);
}

@keyframes expandSearch {
  from {
    opacity: 0;
    transform: scale3d(0.8, 1, 1);
  }
  to {
    opacity: 1;
    transform: scale3d(1, 1, 1);
  }
}

@media (max-width: 480px) {
  app-search-box {
    margin: 0;
    max-width: calc(100vw - 120px);
  }

  .search-expanded {
    left: 48px;
    right: 48px;
  }
}

.spacer {
  flex: 1 1 auto;
}

.main-content {
  flex: 1;
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overflow-x: hidden;
  /* Phase 10: Optimize scroll performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;

  .content-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: min-content;
  }

  .container {
    flex: 1;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
  }
}

.public-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overflow-x: hidden;

  .container {
    flex: 1;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
  }
}

@media (max-width: 599px) {
  :host {
    --header-height: 56px; // Material Design Standard für mobile Header
  }
  .main-content .container {
    padding: 0.5rem;
  }

  .public-content .container {
    padding: 1rem;
  }
}

.page-title-link {
  text-decoration: none;
  gap: 0.5rem; // Abstand zwischen Icon und Text
  color: var(--header-title-color, var(--primary-color, #ffffff));

  // Force white color in dark mode, even for visited links
  &:visited,
  &:hover,
  &:active {
    color: var(--header-title-color, var(--primary-color, #ffffff));
  }
}

.submenu {
  overflow-y: hidden;
  transition: transform 300ms ease;
  transform: scaleY(0);
  transform-origin: top;
  padding-left: 30px;
}
.submenu.expanded {
  transform: scaleY(1);
}

.appDrawer {
  width: 220px; // Feste Breite für den Sidenav
  z-index: 1000; // Sicherstellen, dass der Sidenav über anderen Inhalten liegt
  padding: 0.0rem;

  // Phase 10: GPU acceleration for smoother animations
  will-change: transform;
  transform: translate3d(0, 0, 0);

  // Schnellere Animation für Mobile
  ::ng-deep .mat-drawer-transition & {
    transition-duration: 250ms !important;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1) !important;
  }
}

.user-name {
  margin-left: 0.5rem;
  color: white;
  font-weight: 200;
  font-size: small;
}

@media (max-width: 599px) {
  .appDrawer {
    width: 85vw;
    max-width: 320px;

    // Noch schnellere Animation auf Handsets
    ::ng-deep .mat-drawer-transition & {
      transition-duration: 200ms !important;
    }
  }
}

.hide-on-handset {
  display: none;
}

.own_icon_size {
  width:1.75rem;
  height: 1.75rem;
}

.svg_icon_white {
  color: white;
}

.logo-svg_icon_white svg {
  color: green !important;
}

// ========================================
// BOTTOM NAVIGATION - Mobile Optimiert
// ========================================
.bottom-nav {
  display: none;
}

@media (max-width: 599px) {
  .bottom-nav {
    display: flex;
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 64px;
    background: var(--page-header-bg-color, #fff);
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.15);
    border-top: 1px solid rgba(0, 0, 0, 0.08);
    justify-content: space-around;
    align-items: stretch;
    z-index: 1000;
    padding: 0;
    margin: 0;

    // Phase 10: GPU acceleration for smooth transitions
    will-change: transform;
    transform: translate3d(0, 0, 0);
    transition: transform 200ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  // Navigation Item (Link oder Button)
  .bottom-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: var(--text-secondary, rgba(0, 0, 0, 0.6));
    font-size: 1rem;
    font-weight: 500;
    flex: 1;
    min-width: 0;
    max-width: 168px;
    padding: 6px 12px 8px;
    border-radius: 0;
    transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: visible;

    // Phase 10: Better touch performance
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;

    // Icon Styling
    mat-icon {
      font-size: 1.5rem;
      width: 1.5rem;
      height: 1.5rem;
      line-height: 1.5rem;
      margin-bottom: 4px;
      transition: transform 150ms cubic-bezier(0.4, 0, 0.2, 1);
      // Phase 10: GPU acceleration for icon scaling
      will-change: transform;
    }

    // Label Styling
    .nav-label {
      font-size: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
      transition: opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    // Hover State
    &:hover {
      background-color: rgba(0, 0, 0, 0.04);
    }

    // Active State - Deutlich sichtbar
    &.active {
      color: var(--brand, #1976d2);

      mat-icon {
        // Phase 10: Use scale3d for GPU acceleration
        transform: scale3d(1.1, 1.1, 1);
      }

      // Active Indicator Bar
      &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 2rem;
        height: 3px;
        background: var(--brand, #1976d2);
        border-radius: 0 0 3px 3px;
      }
    }
  }

  .bottom-nav-more {
    flex: 0.8;
  }

  // Sehr kleine Screens - Nur Icons
  @media (max-width: 360px) {
    .bottom-nav {
      height: 56px;
    }

    .bottom-nav-item {
      padding: 8px 4px;

      .nav-label {
        display: none;
      }

      mat-icon {
        margin-bottom: 0;
      }
    }
  }

  // Größere Handsets - Icons + Labels
  @media (min-width: 361px) and (max-width: 599px) {
    .bottom-nav-item .nav-label {
      display: block;
    }
  }

  app-footer,
  .donate-button {
    display: none !important;
  }

  // Platz für Bottom Nav
  .main-content,
  .public-content {
    padding-bottom: 64px;
  }
}

// Overflow Menu Styling
.bottom-nav-overflow {
  max-width: 280px;

  .mat-mdc-menu-item {
    min-height: 48px;
  }
}
